# SQL 关键字过滤功能 - 用户指南

## 🎯 功能介绍

SQL 关键字过滤功能允许您在 binlog 解析过程中，只显示包含指定关键字的 SQL 语句。这对于快速定位特定的数据变更非常有用。

---

## 📍 功能位置

在 GUI 界面的**左侧配置面板**中，**过滤条件**区域：

```
┌─ 过滤条件 ─────────────────────────────┐
│ 数据库:  [________________]             │
│ 表:      [________________]             │
│ 关键字过滤: ☐ 启用关键字过滤            │
│           [输入关键字，多个用空格分隔]  │
└────────────────────────────────────────┘
```

---

## 🚀 快速开始

### 步骤 1：启用过滤
1. 勾选"启用关键字过滤"复选框
2. 文本输入框会自动启用

### 步骤 2：输入关键字
在文本框中输入要过滤的关键字，支持以下格式：

**格式 1：空格分隔**
```
UPDATE DELETE
```

**格式 2：逗号分隔**
```
UPDATE, DELETE, INSERT
```

**格式 3：混合分隔**
```
UPDATE, DELETE INSERT
```

### 步骤 3：开始解析
1. 配置其他解析参数（数据库、表、时间范围等）
2. 点击"开始解析"按钮
3. 只有包含指定关键字的 SQL 语句会被显示

---

## 💡 使用示例

### 示例 1：只看 UPDATE 语句
```
关键字: UPDATE
结果: 只显示 UPDATE 语句
```

### 示例 2：看 UPDATE 和 DELETE 语句
```
关键字: UPDATE DELETE
结果: 显示 UPDATE 或 DELETE 语句
```

### 示例 3：看特定表的操作
```
关键字: users orders
结果: 显示涉及 users 或 orders 表的所有 SQL
```

### 示例 4：看特定值的操作
```
关键字: 12345 admin
结果: 显示包含 12345 或 admin 的 SQL
```

### 示例 5：看特定列的操作
```
关键字: user_id status
结果: 显示涉及 user_id 或 status 列的 SQL
```

---

## ⚙️ 功能特性

### 关键字匹配
- **不区分大小写**：`UPDATE` 和 `update` 被视为相同
- **子字符串匹配**：`user` 会匹配 `users`、`user_id` 等
- **OR 逻辑**：只要 SQL 包含任意一个关键字就会被显示

### 关键字输入
- **支持多个关键字**：输入多个关键字以扩大过滤范围
- **灵活的分隔符**：支持空格、逗号或混合分隔
- **自动处理**：自动去除多余空格和空字符串

### 性能
- **无性能影响**：过滤在 UI 层进行，不影响解析速度
- **实时过滤**：SQL 生成时立即进行过滤
- **内存高效**：只保存匹配的 SQL 语句

---

## 📊 统计信息

解析完成后，日志中会显示过滤统计信息：

```
[INFO] 关键字过滤统计 - 总处理: 1000, 匹配: 350, 过滤: 650
```

含义：
- **总处理**：处理的 SQL 总数
- **匹配**：包含关键字的 SQL 数量
- **过滤**：被过滤掉的 SQL 数量

---

## 💾 设置保存

您的过滤设置会被自动保存，包括：
- 是否启用过滤
- 输入的关键字文本

下次启动应用时，这些设置会被自动恢复。

---

## ⚠️ 常见问题

### Q1：为什么没有看到任何 SQL？
**A**：可能的原因：
- 关键字输入有误
- 数据库中没有包含该关键字的 SQL
- 检查日志中的警告信息

### Q2：关键字匹配是否区分大小写？
**A**：不区分。`UPDATE` 和 `update` 被视为相同。

### Q3：可以使用正则表达式吗？
**A**：目前不支持，只支持简单的子字符串匹配。

### Q4：如何禁用过滤？
**A**：取消勾选"启用关键字过滤"复选框。

### Q5：过滤会影响解析速度吗？
**A**：不会。过滤在 UI 层进行，不影响 binlog 解析速度。

---

## 🔍 调试技巧

### 查看过滤日志
1. 打开应用日志文件
2. 搜索关键字"关键字过滤"
3. 查看过滤统计信息

### 验证关键字
1. 在过滤条件中输入关键字
2. 点击"开始解析"
3. 检查结果中是否包含预期的 SQL

### 测试多关键字
1. 输入多个关键字：`UPDATE DELETE INSERT`
2. 验证结果中是否包含这三种类型的 SQL

---

## 📝 最佳实践

### 1. 精确关键字
使用更精确的关键字以获得更准确的结果：
```
❌ 不好：user
✅ 好的：user_id 或 users 表名
```

### 2. 组合过滤
结合其他过滤条件使用：
```
数据库: mydb
表: users
关键字: UPDATE
结果: 只显示 mydb.users 表的 UPDATE 语句
```

### 3. 逐步细化
从宽泛的关键字开始，逐步细化：
```
第一步：UPDATE DELETE
第二步：UPDATE
第三步：UPDATE users
```

---

## 🎓 高级用法

### 场景 1：审计特定用户的操作
```
关键字: admin root
结果: 显示涉及 admin 或 root 用户的所有操作
```

### 场景 2：追踪特定订单
```
关键字: order_id=12345
结果: 显示与订单 12345 相关的所有操作
```

### 场景 3：监控敏感数据
```
关键字: password email phone
结果: 显示涉及敏感字段的所有操作
```

### 场景 4：性能分析
```
关键字: UPDATE DELETE
结果: 只看修改操作，忽略 INSERT
```

---

## 📞 获取帮助

如遇到问题，请：
1. 检查日志文件中的错误信息
2. 查看本指南的常见问题部分
3. 验证关键字输入格式是否正确
4. 尝试禁用过滤后重新启用

---

## ✨ 总结

SQL 关键字过滤功能是一个强大的工具，可以帮助您：
- 快速定位特定的数据变更
- 专注于感兴趣的 SQL 语句
- 提高工作效率
- 简化数据审计和调试

祝您使用愉快！

